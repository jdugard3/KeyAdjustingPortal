<!DOCTYPE html>
<html>
<head>
  <title>KeyAdjusting Portal - Login</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/main.css">
</head>
<body>
  <nav class="navbar">
    <div class="navbar-content">
      <h1 class="portal-title">Key Adjusting <span>Contractor Portal</span></h1>
    </div>
  </nav>

  <div class="container">
    <div class="login-container">
      <div class="login-options">
        <button class="tab-btn active" data-tab="contractor">Contractor Login</button>
        <button class="tab-btn" data-tab="signup">Sign Up</button>
        <button class="tab-btn" data-tab="admin">Admin Login</button>
      </div>

      <div id="contractor-login" class="login-form active">
        <h2>Contractor Login</h2>
        <% if (typeof error !== 'undefined' && error) { %>
          <div class="alert alert-danger">
            <%= error %>
          </div>
        <% } %>
        <% if (typeof success !== 'undefined' && success) { %>
          <div class="alert alert-success">
            <%= success %>
          </div>
        <% } %>
        <form action="/auth/login" method="POST">
          <div class="form-group">
            <label>Email</label>
            <input type="email" name="email" class="form-control" required 
              value="<%= locals.email || '' %>">
          </div>
          <div class="form-group">
            <label>Password</label>
            <input type="password" name="password" class="form-control" required>
          </div>
          <button type="submit" class="btn">Login</button>
        </form>
      </div>

      <div id="signup-login" class="login-form">
        <h2>Contractor Sign Up</h2>
        <form action="/auth/signup" method="POST">
          <div class="form-group">
            <label for="signupName">Company Name</label>
            <input type="text" id="signupName" name="name" required>
          </div>
          <div class="form-group">
            <label for="signupEmail">Email</label>
            <input type="email" id="signupEmail" name="email" required>
          </div>
          <div class="form-group">
            <label for="signupPassword">Password</label>
            <input type="password" id="signupPassword" name="password" required 
              minlength="8" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{8,}"
              title="Must contain at least one number and one uppercase and lowercase letter, and at least 8 or more characters">
          </div>
          <div class="form-group">
            <label for="confirmPassword">Confirm Password</label>
            <input type="password" id="confirmPassword" name="confirmPassword" required>
          </div>
          <div class="form-group">
            <label for="contractorId">Contractor ID</label>
            <input type="text" id="contractorId" name="contractorId" required>
            <small class="help-text">Your unique contractor ID provided by Key Adjusting</small>
          </div>
          <button type="submit" class="btn btn-primary">Sign Up</button>
        </form>
      </div>

      <div id="admin-login" class="login-form">
        <h2>Admin Login</h2>
        <form action="/auth/admin/login" method="POST">
          <div class="form-group">
            <label for="adminEmail">Email</label>
            <input type="email" id="adminEmail" name="email" required>
          </div>
          <div class="form-group">
            <label for="adminPassword">Password</label>
            <input type="password" id="adminPassword" name="password" required>
          </div>
          <button type="submit" class="btn btn-primary">Login as Admin</button>
        </form>
      </div>
    </div>
  </div>

  <style>
  .login-container {
    max-width: 400px;
    margin: 2rem auto;
    background: var(--card-bg);
    padding: 2rem;
    border-radius: var(--border-radius);
    box-shadow: var(--box-shadow);
  }

  .login-options {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 2rem;
  }

  .tab-btn {
    flex: 1;
    padding: 0.75rem;
    border: none;
    background: var(--background-color);
    color: var(--text-color);
    border-radius: var(--border-radius);
    cursor: pointer;
    transition: var(--transition);
  }

  .tab-btn.active {
    background: var(--primary-color);
    color: white;
  }

  .login-form {
    display: none;
  }

  .login-form.active {
    display: block;
  }

  .form-group {
    margin-bottom: 1.5rem;
  }

  .form-group label {
    display: block;
    margin-bottom: 0.5rem;
    color: var(--text-color);
  }

  .form-group input {
    width: 100%;
    padding: 0.75rem;
    border: 1px solid var(--background-color);
    border-radius: var(--border-radius);
    font-family: inherit;
  }

  .help-text {
    display: block;
    margin-top: 0.25rem;
    font-size: 0.875rem;
    color: var(--text-color);
    opacity: 0.8;
  }
  </style>

  <script>
  document.addEventListener('DOMContentLoaded', function() {
    const tabs = document.querySelectorAll('.tab-btn');
    const forms = document.querySelectorAll('.login-form');
    
    // Password confirmation validation
    const signupForm = document.querySelector('#signup-login form');
    const password = document.getElementById('signupPassword');
    const confirmPassword = document.getElementById('confirmPassword');

    signupForm.addEventListener('submit', function(e) {
      if (password.value !== confirmPassword.value) {
        e.preventDefault();
        alert('Passwords do not match!');
      }
    });

    tabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const targetForm = tab.dataset.tab;
        
        // Update active states
        tabs.forEach(t => t.classList.remove('active'));
        forms.forEach(f => f.classList.remove('active'));
        
        tab.classList.add('active');
        document.getElementById(`${targetForm}-login`).classList.add('active');
      });
    });
  });
  </script>

  <%- include('partials/footer') %>
</body>
</html> 